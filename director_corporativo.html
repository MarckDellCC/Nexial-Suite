<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Director Corporativo - Nexial Suite</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; background: #0f172a; color: white; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #334155; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #334155; border: none; color: white; cursor: pointer; border-radius: 5px; }
        .tab.active { background: #7c3aed; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #1e293b; border: 1px solid #334155; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #334155; }
        th { background: #0f172a; }
        .btn { padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 2px; }
        .btn-primary { background: #7c3aed; color: white; }
        .btn-secondary { background: #334155; color: white; }
        .btn-danger { background: #dc2626; color: white; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: #1e293b; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #cbd5e1; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; background: #0f172a; border: 1px solid #475569; border-radius: 5px; color: white; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
        .error { background: #dc2626; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; display: none; }
        .success { background: #059669; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; display: none; }
        .loading { text-align: center; padding: 20px; }
        .section-controls { display: flex; gap: 10px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Director Corporativo</h1>
            <div>
                <span id="userEmail"></span>
                <button class="btn btn-danger" onclick="logout()">Cerrar Sesión</button>
            </div>
        </header>

        <div id="errorMessage" class="error"></div>
        <div id="successMessage" class="success"></div>

        <div class="tabs">
            <button class="tab active" onclick="showSection('empresas')">Empresas</button>
            <button class="tab" onclick="showSection('usuarios')">Usuarios</button>
            <button class="tab" onclick="showSection('empleados')">Empleados</button>
        </div>

        <!-- Sección Empresas -->
        <div id="empresasSection" class="content-section active">
            <div class="section-controls">
                <button class="btn btn-primary" onclick="abrirModalEmpresa()">Nueva Empresa</button>
                <button class="btn btn-secondary" onclick="cargarEmpresas()">Actualizar</button>
            </div>
            <div id="empresasLoading" class="loading">Cargando empresas...</div>
            <table id="empresasTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>País</th>
                        <th>Ciudad</th>
                        <th>Email</th>
                        <th>Teléfono</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="empresasBody"></tbody>
            </table>
        </div>

        <!-- Sección Usuarios -->
        <div id="usuariosSection" class="content-section">
            <div class="section-controls">
                <button class="btn btn-primary" onclick="abrirModalUsuario()">Nuevo Usuario</button>
                <button class="btn btn-secondary" onclick="cargarUsuarios()">Actualizar</button>
            </div>
            <div id="usuariosLoading" class="loading">Cargando usuarios...</div>
            <table id="usuariosTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Email</th>
                        <th>Rol</th>
                        <th>Empresa</th>
                        <th>Creado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="usuariosBody"></tbody>
            </table>
        </div>

        <!-- Sección Empleados -->
        <div id="empleadosSection" class="content-section">
            <div class="section-controls">
                <button class="btn btn-primary" onclick="abrirModalEmpleado()">Nuevo Empleado</button>
                <button class="btn btn-secondary" onclick="cargarEmpleados()">Actualizar</button>
            </div>
            <div id="empleadosLoading" class="loading">Cargando empleados...</div>
            <table id="empleadosTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Cargo</th>
                        <th>Empresa</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="empleadosBody"></tbody>
            </table>
        </div>

        <!-- Modal Empresa -->
        <div id="modalEmpresa" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalEmpresaTitulo">Nueva Empresa</h2>
                    <button onclick="cerrarModal('modalEmpresa')">&times;</button>
                </div>
                <form id="formEmpresa">
                    <input type="hidden" id="empresa_id">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="nombre_empresa" required>
                    </div>
                    <div class="form-group">
                        <label>País *</label>
                        <input type="text" id="pais" required>
                    </div>
                    <div class="form-group">
                        <label>Ciudad *</label>
                        <input type="text" id="ciudad" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email_empresa">
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" id="telefono_empresa">
                    </div>
                    <div class="form-group">
                        <label>Dirección</label>
                        <textarea id="direccion"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalEmpresa')">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Usuario -->
        <div id="modalUsuario" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalUsuarioTitulo">Nuevo Usuario</h2>
                    <button onclick="cerrarModal('modalUsuario')">&times;</button>
                </div>
                <form id="formUsuario">
                    <input type="hidden" id="usuario_id">
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="usuario_email" required>
                    </div>
                    <div class="form-group">
                        <label>Contraseña (solo para nuevo)</label>
                        <input type="password" id="usuario_password">
                    </div>
                    <div class="form-group">
                        <label>Rol *</label>
                        <select id="usuario_rol" required>
                            <option value="">Seleccionar</option>
                            <option value="director">Director</option>
                            <option value="gerente">Gerente</option>
                            <option value="supervisor">Supervisor</option>
                            <option value="empleado">Empleado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Empresa (opcional)</label>
                        <select id="usuario_empresa_id">
                            <option value="">Sin empresa</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalUsuario')">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Empleado -->
        <div id="modalEmpleado" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalEmpleadoTitulo">Nuevo Empleado</h2>
                    <button onclick="cerrarModal('modalEmpleado')">&times;</button>
                </div>
                <form id="formEmpleado">
                    <input type="hidden" id="empleado_id">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="empleado_nombre" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="empleado_email">
                    </div>
                    <div class="form-group">
                        <label>Cargo *</label>
                        <input type="text" id="empleado_cargo" required>
                    </div>
                    <div class="form-group">
                        <label>Empresa *</label>
                        <select id="empleado_empresa_id" required>
                            <option value="">Seleccionar empresa</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="text" id="empleado_telefono">
                    </div>
                    <div class="form-group">
                        <label>Salario</label>
                        <input type="number" id="empleado_salario">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalEmpleado')">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Configuración de Supabase
        const SUPABASE_URL = 'https://zshnzeqstrdzuljqueto.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_J8vYye7ZumaK4hGoRwaIpQ_O_kj0ERX';
        let supabase = null;
        let session = null;

        // Inicializar aplicación
        async function init() {
            try {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                const { data: { session: currentSession }, error } = await supabase.auth.getSession();
                
                if (error || !currentSession) {
                    window.location.href = 'login.html';
                    return;
                }
                
                session = currentSession;
                document.getElementById('userEmail').textContent = session.user.email;
                
                // Cargar datos iniciales
                await cargarEmpresas();
                await cargarUsuarios();
                await cargarEmpleados();
                
                // Configurar eventos
                setupEventListeners();
                
            } catch (error) {
                mostrarError('Error al inicializar: ' + error.message);
            }
        }

        // Funciones para mostrar/ocultar secciones
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(sectionName + 'Section').classList.add('active');
            document.querySelector(`.tab[onclick="showSection('${sectionName}')"]`).classList.add('active');
        }

        // ========== EMPRESAS ==========
        async function cargarEmpresas() {
            try {
                mostrarCarga('empresasLoading', true);
                const { data, error } = await supabase.from('empresas').select('*').order('nombre_empresa');
                
                if (error) throw error;
                
                const tbody = document.getElementById('empresasBody');
                tbody.innerHTML = '';
                
                if (!data || data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7">No hay empresas registradas</td></tr>';
                    return;
                }
                
                data.forEach(empresa => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${empresa.id.substring(0, 8)}...</td>
                        <td>${empresa.nombre_empresa || '-'}</td>
                        <td>${empresa.pais || '-'}</td>
                        <td>${empresa.ciudad || '-'}</td>
                        <td>${empresa.email_empresa || '-'}</td>
                        <td>${empresa.telefono_empresa || '-'}</td>
                        <td>
                            <button class="btn btn-secondary" onclick="editarEmpresa('${empresa.id}')">Editar</button>
                            <button class="btn btn-danger" onclick="eliminarEmpresa('${empresa.id}')">Eliminar</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
                
            } catch (error) {
                mostrarError('Error al cargar empresas: ' + error.message);
            } finally {
                mostrarCarga('empresasLoading', false);
            }
        }

        async function abrirModalEmpresa(id = null) {
            document.getElementById('modalEmpresaTitulo').textContent = id ? 'Editar Empresa' : 'Nueva Empresa';
            document.getElementById('empresa_id').value = id || '';
            document.getElementById('formEmpresa').reset();
            
            if (id) {
                try {
                    const { data, error } = await supabase.from('empresas').select('*').eq('id', id).single();
                    if (error) throw error;
                    
                    document.getElementById('nombre_empresa').value = data.nombre_empresa || '';
                    document.getElementById('pais').value = data.pais || '';
                    document.getElementById('ciudad').value = data.ciudad || '';
                    document.getElementById('email_empresa').value = data.email_empresa || '';
                    document.getElementById('telefono_empresa').value = data.telefono_empresa || '';
                    document.getElementById('direccion').value = data.direccion || '';
                } catch (error) {
                    mostrarError('Error al cargar empresa: ' + error.message);
                    return;
                }
            }
            
            document.getElementById('modalEmpresa').style.display = 'flex';
        }

        async function guardarEmpresa(event) {
            event.preventDefault();
            
            const id = document.getElementById('empresa_id').value;
            const empresaData = {
                nombre_empresa: document.getElementById('nombre_empresa').value,
                pais: document.getElementById('pais').value,
                ciudad: document.getElementById('ciudad').value,
                email_empresa: document.getElementById('email_empresa').value || null,
                telefono_empresa: document.getElementById('telefono_empresa').value || null,
                direccion: document.getElementById('direccion').value || null
            };
            
            try {
                let result;
                if (id) {
                    result = await supabase.from('empresas').update(empresaData).eq('id', id);
                } else {
                    result = await supabase.from('empresas').insert([empresaData]);
                }
                
                if (result.error) throw result.error;
                
                mostrarExito(id ? 'Empresa actualizada correctamente' : 'Empresa creada correctamente');
                cerrarModal('modalEmpresa');
                await cargarEmpresas();
                
            } catch (error) {
                mostrarError('Error al guardar empresa: ' + error.message);
            }
        }

        async function eliminarEmpresa(id) {
            if (!confirm('¿Está seguro de eliminar esta empresa?')) return;
            
            try {
                const { error } = await supabase.from('empresas').delete().eq('id', id);
                if (error) throw error;
                
                mostrarExito('Empresa eliminada correctamente');
                await cargarEmpresas();
            } catch (error) {
                mostrarError('Error al eliminar empresa: ' + error.message);
            }
        }

        // ========== USUARIOS ==========
        async function cargarUsuarios() {
            try {
                mostrarCarga('usuariosLoading', true);
                const { data, error } = await supabase.from('usuarios').select('*, empresas(nombre_empresa)').order('email');
                
                if (error) throw error;
                
                const tbody = document.getElementById('usuariosBody');
                tbody.innerHTML = '';
                
                if (!data || data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6">No hay usuarios registrados</td></tr>';
                    return;
                }
                
                data.forEach(usuario => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${usuario.id.substring(0, 8)}...</td>
                        <td>${usuario.email}</td>
                        <td>${usuario.rol || '-'}</td>
                        <td>${usuario.empresas?.nombre_empresa || '-'}</td>
                        <td>${new Date(usuario.created_at).toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-secondary" onclick="editarUsuario('${usuario.id}')">Editar</button>
                            <button class="btn btn-danger" onclick="eliminarUsuario('${usuario.id}')">Eliminar</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
                
            } catch (error) {
                mostrarError('Error al cargar usuarios: ' + error.message);
            } finally {
                mostrarCarga('usuariosLoading', false);
            }
        }

        async function abrirModalUsuario(id = null) {
            // Cargar empresas para el select
            await cargarEmpresasParaSelect('usuario_empresa_id');
            
            document.getElementById('modalUsuarioTitulo').textContent = id ? 'Editar Usuario' : 'Nuevo Usuario';
            document.getElementById('usuario_id').value = id || '';
            document.getElementById('formUsuario').reset();
            
            if (id) {
                try {
                    const { data, error } = await supabase.from('usuarios').select('*').eq('id', id).single();
                    if (error) throw error;
                    
                    document.getElementById('usuario_email').value = data.email || '';
                    document.getElementById('usuario_rol').value = data.rol || '';
                    document.getElementById('usuario_empresa_id').value = data.empresa_id || '';
                } catch (error) {
                    mostrarError('Error al cargar usuario: ' + error.message);
                    return;
                }
            }
            
            document.getElementById('modalUsuario').style.display = 'flex';
        }

        async function guardarUsuario(event) {
            event.preventDefault();
            
            const id = document.getElementById('usuario_id').value;
            const usuarioData = {
                email: document.getElementById('usuario_email').value,
                rol: document.getElementById('usuario_rol').value,
                empresa_id: document.getElementById('usuario_empresa_id').value || null
            };
            
            const password = document.getElementById('usuario_password').value;
            
            try {
                let result;
                if (id) {
                    // Actualizar usuario existente
                    result = await supabase.from('usuarios').update(usuarioData).eq('id', id);
                } else {
                    // Crear nuevo usuario (necesita autenticación)
                    if (!password) {
                        mostrarError('Se requiere contraseña para nuevo usuario');
                        return;
                    }
                    
                    const { data: authData, error: authError } = await supabase.auth.admin.createUser({
                        email: usuarioData.email,
                        password: password,
                        email_confirm: true
                    });
                    
                    if (authError) throw authError;
                    
                    // Agregar datos adicionales a la tabla usuarios
                    usuarioData.id = authData.user.id;
                    result = await supabase.from('usuarios').insert([usuarioData]);
                }
                
                if (result.error) throw result.error;
                
                mostrarExito(id ? 'Usuario actualizado correctamente' : 'Usuario creado correctamente');
                cerrarModal('modalUsuario');
                await cargarUsuarios();
                
            } catch (error) {
                mostrarError('Error al guardar usuario: ' + error.message);
            }
        }

        async function eliminarUsuario(id) {
            if (!confirm('¿Está seguro de eliminar este usuario?')) return;
            
            try {
                const { error } = await supabase.from('usuarios').delete().eq('id', id);
                if (error) throw error;
                
                mostrarExito('Usuario eliminado correctamente');
                await cargarUsuarios();
            } catch (error) {
                mostrarError('Error al eliminar usuario: ' + error.message);
            }
        }

        // ========== EMPLEADOS ==========
        async function cargarEmpleados() {
            try {
                mostrarCarga('empleadosLoading', true);
                const { data, error } = await supabase.from('empleados').select('*, empresas(nombre_empresa)').order('nombre');
                
                if (error) throw error;
                
                const tbody = document.getElementById('empleadosBody');
                tbody.innerHTML = '';
                
                if (!data || data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6">No hay empleados registrados</td></tr>';
                    return;
                }
                
                data.forEach(empleado => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${empleado.id.substring(0, 8)}...</td>
                        <td>${empleado.nombre}</td>
                        <td>${empleado.email || '-'}</td>
                        <td>${empleado.cargo || '-'}</td>
                        <td>${empleado.empresas?.nombre_empresa || '-'}</td>
                        <td>
                            <button class="btn btn-secondary" onclick="editarEmpleado('${empleado.id}')">Editar</button>
                            <button class="btn btn-danger" onclick="eliminarEmpleado('${empleado.id}')">Eliminar</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
                
            } catch (error) {
                mostrarError('Error al cargar empleados: ' + error.message);
            } finally {
                mostrarCarga('empleadosLoading', false);
            }
        }

        async function abrirModalEmpleado(id = null) {
            // Cargar empresas para el select
            await cargarEmpresasParaSelect('empleado_empresa_id');
            
            document.getElementById('modalEmpleadoTitulo').textContent = id ? 'Editar Empleado' : 'Nuevo Empleado';
            document.getElementById('empleado_id').value = id || '';
            document.getElementById('formEmpleado').reset();
            
            if (id) {
                try {
                    const { data, error } = await supabase.from('empleados').select('*').eq('id', id).single();
                    if (error) throw error;
                    
                    document.getElementById('empleado_nombre').value = data.nombre || '';
                    document.getElementById('empleado_email').value = data.email || '';
                    document.getElementById('empleado_cargo').value = data.cargo || '';
                    document.getElementById('empleado_empresa_id').value = data.empresa_id || '';
                    document.getElementById('empleado_telefono').value = data.telefono || '';
                    document.getElementById('empleado_salario').value = data.salario || '';
                } catch (error) {
                    mostrarError('Error al cargar empleado: ' + error.message);
                    return;
                }
            }
            
            document.getElementById('modalEmpleado').style.display = 'flex';
        }

        async function guardarEmpleado(event) {
            event.preventDefault();
            
            const id = document.getElementById('empleado_id').value;
            const empleadoData = {
                nombre: document.getElementById('empleado_nombre').value,
                email: document.getElementById('empleado_email').value || null,
                cargo: document.getElementById('empleado_cargo').value,
                empresa_id: document.getElementById('empleado_empresa_id').value,
                telefono: document.getElementById('empleado_telefono').value || null,
                salario: document.getElementById('empleado_salario').value || null
            };
            
            try {
                let result;
                if (id) {
                    result = await supabase.from('empleados').update(empleadoData).eq('id', id);
                } else {
                    result = await supabase.from('empleados').insert([empleadoData]);
                }
                
                if (result.error) throw result.error;
                
                mostrarExito(id ? 'Empleado actualizado correctamente' : 'Empleado creado correctamente');
                cerrarModal('modalEmpleado');
                await cargarEmpleados();
                
            } catch (error) {
                mostrarError('Error al guardar empleado: ' + error.message);
            }
        }

        async function eliminarEmpleado(id) {
            if (!confirm('¿Está seguro de eliminar este empleado?')) return;
            
            try {
                const { error } = await supabase.from('empleados').delete().eq('id', id);
                if (error) throw error;
                
                mostrarExito('Empleado eliminado correctamente');
                await cargarEmpleados();
            } catch (error) {
                mostrarError('Error al eliminar empleado: ' + error.message);
            }
        }

        // ========== FUNCIONES UTILITARIAS ==========
        async function cargarEmpresasParaSelect(selectId) {
            try {
                const { data, error } = await supabase.from('empresas').select('id, nombre_empresa').order('nombre_empresa');
                if (error) throw error;
                
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Seleccionar empresa</option>';
                
                data.forEach(empresa => {
                    const option = document.createElement('option');
                    option.value = empresa.id;
                    option.textContent = empresa.nombre_empresa;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Error al cargar empresas para select:', error);
            }
        }

        function mostrarCarga(elementId, mostrar) {
            document.getElementById(elementId).style.display = mostrar ? 'block' : 'none';
        }

        function mostrarError(mensaje) {
            const div = document.getElementById('errorMessage');
            div.textContent = mensaje;
            div.style.display = 'block';
            setTimeout(() => div.style.display = 'none', 5000);
        }

        function mostrarExito(mensaje) {
            const div = document.getElementById('successMessage');
            div.textContent = mensaje;
            div.style.display = 'block';
            setTimeout(() => div.style.display = 'none', 3000);
        }

        function cerrarModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        async function logout() {
            await supabase.auth.signOut();
            localStorage.removeItem('nexial_user');
            window.location.href = 'index.html';
        }

        function setupEventListeners() {
            document.getElementById('formEmpresa').addEventListener('submit', guardarEmpresa);
            document.getElementById('formUsuario').addEventListener('submit', guardarUsuario);
            document.getElementById('formEmpleado').addEventListener('submit', guardarEmpleado);
            
            // Cerrar modales al hacer clic fuera
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) this.style.display = 'none';
                });
            });
        }

        // Iniciar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
